import{e as _}from"./index-DiZwQw_Q.js";import{_ as W,u as X,j as Y,o as Z,c as I,d as l,w as i,e as t,N as z,k as R,r as u,a2 as ee,f as U,b as n,i as f,t as C,v as x,s as S,l as ae,B as m,C as T,D as d,S as p,q as le,E as B,P as y,p as te,U as q}from"./index-9-2YgmGC.js";const se={class:"email-config-container"},ie={key:0,class:"active-config mb-6"},oe={class:"config-details"},re={class:"detail-item"},ne={class:"value"},de={class:"detail-item"},ue={class:"detail-item"},ve={class:"value"},pe={class:"detail-item"},ce={key:0,class:"detail-item"},fe={class:"value"},me={class:"flex justify-end gap-2"},ye={class:"flex justify-end gap-2"},_e={__name:"EmailConfig",setup(ge){const c=X(),D=Y(),N=u(!1),E=u([]),v=u(null),g=u(!1),k=u(!1),h=u(!1),A=u(!1),F=u(null),K=u(null),V=u(null),o=u({config_name:"",provider:"resend",api_key:"",secret_key:"",sender_email:"",test_email:"",test_mode:1,description:""}),r=u({provider:"",api_key:"",secret_key:"",sender_email:"",test_email:"",test_mode:1,description:""}),$=[{label:"Resend",value:"resend"},{label:"é˜¿é‡Œäº‘é‚®ä»¶æŽ¨é€",value:"aliyun"}],M=q({get:()=>o.value.test_mode===1,set:a=>{o.value.test_mode=a?1:0}}),P=q({get:()=>r.value.test_mode===1,set:a=>{r.value.test_mode=a?1:0}}),j={config_name:[{required:!0,message:"è¯·è¾“å…¥é…ç½®åç§°",trigger:"blur"}],api_key:[{required:!0,message:"è¯·è¾“å…¥API Key",trigger:"blur"}],sender_email:[{required:!0,message:"è¯·è¾“å…¥å‘ä»¶äººé‚®ç®±",trigger:"blur"},{type:"email",message:"è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€",trigger:"blur"}]},L=[{title:"é…ç½®åç§°",key:"config_name",width:150},{title:"æœåŠ¡å•†",key:"provider",width:120,render(a){return y(x,{type:a.provider==="aliyun"?"info":"primary",size:"small"},{default:()=>a.provider==="aliyun"?"é˜¿é‡Œäº‘":"Resend"})}},{title:"å‘ä»¶äººé‚®ç®±",key:"sender_email"},{title:"æµ‹è¯•æ¨¡å¼",key:"test_mode",width:100,render(a){return y(x,{type:a.test_mode?"warning":"success",size:"small"},{default:()=>a.test_mode?"å¼€å¯":"å…³é—­"})}},{title:"çŠ¶æ€",key:"is_active",width:100,render(a){return y(x,{type:a.is_active?"success":"default",size:"small"},{default:()=>a.is_active?"æ¿€æ´»":"æœªæ¿€æ´»"})}},{title:"åˆ›å»ºæ—¶é—´",key:"created_at",width:160,render(a){return new Date(a.created_at).toLocaleString("zh-CN")}},{title:"æ“ä½œ",key:"actions",width:220,render(a){return y(te,{},{default:()=>[y(m,{size:"small",type:a.is_active?"default":"primary",disabled:a.is_active===1,onClick:()=>J(a.id)},{default:()=>a.is_active?"å·²æ¿€æ´»":"æ¿€æ´»"}),y(m,{size:"small",onClick:()=>G(a)},{default:()=>"ç¼–è¾‘"}),y(m,{size:"small",type:"error",disabled:a.is_active===1,onClick:()=>Q(a)},{default:()=>"åˆ é™¤"})]})}}],b=async()=>{N.value=!0;try{const a=await _.getConfigs();E.value=Array.isArray(a)?a:[];try{v.value=await _.getActiveConfig()}catch{v.value=null}}catch(a){console.error("åŠ è½½é…ç½®å¤±è´¥:",a),c.error("åŠ è½½é…ç½®å¤±è´¥")}finally{N.value=!1}},O=async()=>{var a;try{await((a=K.value)==null?void 0:a.validate())}catch{return}h.value=!0;try{const e={...o.value};e.test_email||delete e.test_email,e.description||delete e.description,e.provider!=="aliyun"&&!e.secret_key&&delete e.secret_key,(await _.createConfig(e)).success&&(c.success("é…ç½®åˆ›å»ºæˆåŠŸ"),g.value=!1,o.value={config_name:"",provider:"resend",api_key:"",secret_key:"",sender_email:"",test_email:"",test_mode:1,description:""},b())}catch{c.error("åˆ›å»ºå¤±è´¥")}finally{h.value=!1}},G=a=>{F.value=a.id,r.value={api_key:"",sender_email:a.sender_email,test_email:a.test_email,test_mode:a.test_mode,description:a.description},k.value=!0},H=async()=>{A.value=!0;try{const a={};r.value.api_key&&(a.api_key=r.value.api_key),r.value.sender_email&&(a.sender_email=r.value.sender_email),r.value.test_email&&(a.test_email=r.value.test_email),a.test_mode=r.value.test_mode,r.value.description&&(a.description=r.value.description),(await _.updateConfig(F.value,a)).success&&(c.success("é…ç½®æ›´æ–°æˆåŠŸ"),k.value=!1,b())}catch{c.error("æ›´æ–°å¤±è´¥")}finally{A.value=!1}},J=a=>{D.warning({title:"ç¡®è®¤æ¿€æ´»",content:"æ¿€æ´»æ­¤é…ç½®åŽï¼Œæ‰€æœ‰é‚®ä»¶å°†ä½¿ç”¨æ­¤é…ç½®å‘é€ã€‚æ˜¯å¦ç»§ç»­ï¼Ÿ",positiveText:"ç¡®å®š",negativeText:"å–æ¶ˆ",onPositiveClick:async()=>{try{const e=await _.activateConfig(a);e.success&&(c.success(e.message),b())}catch{c.error("æ¿€æ´»å¤±è´¥")}}})},Q=a=>{D.error({title:"ç¡®è®¤åˆ é™¤",content:`ç¡®å®šè¦åˆ é™¤é…ç½®"${a.config_name}"å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚`,positiveText:"ç¡®å®š",negativeText:"å–æ¶ˆ",onPositiveClick:async()=>{var e,w;try{(await _.deleteConfig(a.id)).success&&(c.success("åˆ é™¤æˆåŠŸ"),b())}catch(s){c.error(((w=(e=s.response)==null?void 0:e.data)==null?void 0:w.detail)||"åˆ é™¤å¤±è´¥")}}})};return Z(()=>{b()}),(a,e)=>{const w=ee("n-select");return U(),I("div",se,[l(t(z),{title:"ðŸ“§ é‚®ä»¶å‘é€é…ç½®",bordered:!1},{"header-extra":i(()=>[l(t(m),{type:"primary",onClick:e[0]||(e[0]=s=>g.value=!0)},{icon:i(()=>[...e[18]||(e[18]=[n("i",{class:"fas fa-plus"},null,-1)])]),default:i(()=>[e[19]||(e[19]=f(" æ–°å¢žé…ç½® ",-1))]),_:1})]),default:i(()=>[v.value?(U(),I("div",ie,[e[25]||(e[25]=n("div",{class:"active-badge"},[n("i",{class:"fas fa-check-circle"}),f(" å½“å‰æ¿€æ´»é…ç½® ")],-1)),n("div",oe,[n("div",re,[e[20]||(e[20]=n("span",{class:"label"},"é…ç½®åç§°ï¼š",-1)),n("span",ne,C(v.value.config_name),1)]),n("div",de,[e[21]||(e[21]=n("span",{class:"label"},"æœåŠ¡å•†ï¼š",-1)),l(t(x),{type:v.value.provider==="aliyun"?"info":"primary"},{default:i(()=>[f(C(v.value.provider==="aliyun"?"é˜¿é‡Œäº‘":"Resend"),1)]),_:1},8,["type"])]),n("div",ue,[e[22]||(e[22]=n("span",{class:"label"},"å‘ä»¶äººï¼š",-1)),n("span",ve,C(v.value.sender_email),1)]),n("div",pe,[e[23]||(e[23]=n("span",{class:"label"},"æµ‹è¯•æ¨¡å¼ï¼š",-1)),l(t(x),{type:v.value.test_mode?"warning":"success"},{default:i(()=>[f(C(v.value.test_mode?"å¼€å¯":"å…³é—­"),1)]),_:1},8,["type"])]),v.value.test_mode?(U(),I("div",ce,[e[24]||(e[24]=n("span",{class:"label"},"æµ‹è¯•é‚®ç®±ï¼š",-1)),n("span",fe,C(v.value.test_email),1)])):S("",!0)])])):S("",!0),l(t(ae),{columns:L,data:E.value,loading:N.value,bordered:!1},null,8,["data","loading"])]),_:1}),l(t(R),{show:g.value,"onUpdate:show":e[10]||(e[10]=s=>g.value=s)},{default:i(()=>[l(t(z),{style:{width:"600px"},title:"æ–°å¢žé‚®ä»¶é…ç½®",bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{footer:i(()=>[n("div",me,[l(t(m),{onClick:e[9]||(e[9]=s=>g.value=!1)},{default:i(()=>[...e[27]||(e[27]=[f("å–æ¶ˆ",-1)])]),_:1}),l(t(m),{type:"primary",loading:h.value,onClick:O},{default:i(()=>[...e[28]||(e[28]=[f(" åˆ›å»º ",-1)])]),_:1},8,["loading"])])]),default:i(()=>[l(t(T),{ref_key:"createFormRef",ref:K,model:o.value,rules:j,"label-placement":"left","label-width":"120"},{default:i(()=>[l(t(d),{label:"é…ç½®åç§°",path:"config_name"},{default:i(()=>[l(t(p),{value:o.value.config_name,"onUpdate:value":e[1]||(e[1]=s=>o.value.config_name=s),placeholder:"ä¾‹å¦‚ï¼šç”Ÿäº§çŽ¯å¢ƒ"},null,8,["value"])]),_:1}),l(t(d),{label:"é‚®ç®±æœåŠ¡å•†",path:"provider"},{default:i(()=>[l(w,{value:o.value.provider,"onUpdate:value":e[2]||(e[2]=s=>o.value.provider=s),options:$,placeholder:"é€‰æ‹©é‚®ç®±æœåŠ¡å•†"},null,8,["value"])]),_:1}),l(t(d),{label:o.value.provider==="aliyun"?"Access Key ID":"API Key",path:"api_key"},{default:i(()=>[l(t(p),{value:o.value.api_key,"onUpdate:value":e[3]||(e[3]=s=>o.value.api_key=s),type:"password","show-password-on":"click",placeholder:o.value.provider==="aliyun"?"é˜¿é‡Œäº‘ Access Key ID":"Resend API Key"},null,8,["value","placeholder"])]),_:1},8,["label"]),o.value.provider==="aliyun"?(U(),le(t(d),{key:0,label:"Access Key Secret",path:"secret_key"},{default:i(()=>[l(t(p),{value:o.value.secret_key,"onUpdate:value":e[4]||(e[4]=s=>o.value.secret_key=s),type:"password","show-password-on":"click",placeholder:"é˜¿é‡Œäº‘ Access Key Secret"},null,8,["value"])]),_:1})):S("",!0),l(t(d),{label:"å‘ä»¶äººé‚®ç®±",path:"sender_email"},{default:i(()=>[l(t(p),{value:o.value.sender_email,"onUpdate:value":e[5]||(e[5]=s=>o.value.sender_email=s),placeholder:o.value.provider==="aliyun"?"éœ€åœ¨é˜¿é‡Œäº‘é…ç½®çš„å‘ä¿¡åœ°å€":"onboarding@resend.dev"},null,8,["value","placeholder"])]),_:1}),l(t(d),{label:"æµ‹è¯•é‚®ç®±",path:"test_email"},{default:i(()=>[l(t(p),{value:o.value.test_email,"onUpdate:value":e[6]||(e[6]=s=>o.value.test_email=s),placeholder:"ç”¨äºŽæµ‹è¯•æ¨¡å¼æŽ¥æ”¶é‚®ä»¶"},null,8,["value"])]),_:1}),l(t(d),{label:"æµ‹è¯•æ¨¡å¼",path:"test_mode"},{default:i(()=>[l(t(B),{value:M.value,"onUpdate:value":e[7]||(e[7]=s=>M.value=s)},null,8,["value"]),e[26]||(e[26]=n("span",{class:"ml-2 text-xs text-gray-500"}," å¼€å¯åŽæ‰€æœ‰é‚®ä»¶å°†å‘é€åˆ°æµ‹è¯•é‚®ç®± ",-1))]),_:1}),l(t(d),{label:"å¤‡æ³¨è¯´æ˜Ž",path:"description"},{default:i(()=>[l(t(p),{value:o.value.description,"onUpdate:value":e[8]||(e[8]=s=>o.value.description=s),type:"textarea",rows:3,placeholder:"å¯é€‰"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show"]),l(t(R),{show:k.value,"onUpdate:show":e[17]||(e[17]=s=>k.value=s)},{default:i(()=>[l(t(z),{style:{width:"600px"},title:"ç¼–è¾‘é‚®ä»¶é…ç½®",bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{footer:i(()=>[n("div",ye,[l(t(m),{onClick:e[16]||(e[16]=s=>k.value=!1)},{default:i(()=>[...e[29]||(e[29]=[f("å–æ¶ˆ",-1)])]),_:1}),l(t(m),{type:"primary",loading:A.value,onClick:H},{default:i(()=>[...e[30]||(e[30]=[f(" ä¿å­˜ ",-1)])]),_:1},8,["loading"])])]),default:i(()=>[l(t(T),{ref_key:"editFormRef",ref:V,model:r.value,"label-placement":"left","label-width":"120"},{default:i(()=>[l(t(d),{label:"API Key"},{default:i(()=>[l(t(p),{value:r.value.api_key,"onUpdate:value":e[11]||(e[11]=s=>r.value.api_key=s),type:"password","show-password-on":"click",placeholder:"ç•™ç©ºåˆ™ä¸ä¿®æ”¹"},null,8,["value"])]),_:1}),l(t(d),{label:"å‘ä»¶äººé‚®ç®±"},{default:i(()=>[l(t(p),{value:r.value.sender_email,"onUpdate:value":e[12]||(e[12]=s=>r.value.sender_email=s),placeholder:"ç•™ç©ºåˆ™ä¸ä¿®æ”¹"},null,8,["value"])]),_:1}),l(t(d),{label:"æµ‹è¯•é‚®ç®±"},{default:i(()=>[l(t(p),{value:r.value.test_email,"onUpdate:value":e[13]||(e[13]=s=>r.value.test_email=s),placeholder:"ç•™ç©ºåˆ™ä¸ä¿®æ”¹"},null,8,["value"])]),_:1}),l(t(d),{label:"æµ‹è¯•æ¨¡å¼"},{default:i(()=>[l(t(B),{value:P.value,"onUpdate:value":e[14]||(e[14]=s=>P.value=s)},null,8,["value"])]),_:1}),l(t(d),{label:"å¤‡æ³¨è¯´æ˜Ž"},{default:i(()=>[l(t(p),{value:r.value.description,"onUpdate:value":e[15]||(e[15]=s=>r.value.description=s),type:"textarea",rows:3},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])])}}},we=W(_e,[["__scopeId","data-v-0577bc2a"]]);export{we as default};
