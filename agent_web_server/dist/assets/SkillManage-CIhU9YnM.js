import{u as L,j as P,o as Q,c as u,b as s,V as R,d as l,w as n,e as o,B as p,F as N,z as j,v as T,T as I,E as W,t as i,k as V,r as d,U as J,f as c,i as v,S as B,W as O,s as M}from"./index-9-2YgmGC.js";import{f as m}from"./index-DiZwQw_Q.js";const X={class:"flex items-center justify-between mb-6"},Y={class:"flex gap-2 mb-4"},Z={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4"},ee={class:"flex items-start justify-between mb-3"},te={class:"font-bold text-slate-800 text-sm mb-1"},se={class:"text-xs text-slate-400 mb-1"},ae={class:"text-xs text-slate-500 flex-1 line-clamp-2 mb-3"},le={class:"flex items-center justify-between"},ne={class:"flex items-center gap-2"},oe={class:"text-xs text-slate-400"},ie={class:"flex gap-1"},re={key:1,class:"text-center py-16 text-slate-400"},ue={class:"space-y-4"},de={class:"border-t pt-4"},ce={class:"flex gap-2 mb-3"},ve={key:0,class:"space-y-2 max-h-60 overflow-y-auto"},fe={class:"flex-1 min-w-0"},ge={class:"text-sm font-medium text-slate-700 truncate"},pe={class:"text-xs text-slate-400 truncate"},xe={class:"flex justify-end gap-2"},me={key:0},ye={class:"flex items-center gap-3 mb-4"},be={class:"text-lg font-bold"},we={class:"text-sm text-slate-500 mb-4"},he={class:"bg-slate-50 rounded-xl p-4 max-h-96 overflow-y-auto"},_e={class:"text-xs text-slate-600 whitespace-pre-wrap"},ze={__name:"SkillManage",setup(ke){const r=L(),q=P(),_=d([]),y=d(""),b=d(!1),f=d(""),k=d(!1),w=d(""),S=d([]),C=d(!1),z=d(!1),x=d(null),A=[{label:"全部",value:""},{label:"测试",value:"testing"},{label:"浏览器",value:"browser"},{label:"接口",value:"api"},{label:"通用",value:"general"}],U=J(()=>y.value?_.value.filter(a=>a.category===y.value):_.value);function $(a){const e={testing:{bg:"bg-emerald-500",icon:"fas fa-vial"},browser:{bg:"bg-blue-500",icon:"fas fa-globe"},api:{bg:"bg-orange-500",icon:"fas fa-plug"},general:{bg:"bg-slate-500",icon:"fas fa-cube"}};return e[a]||e.general}function E(a){return{testing:"success",browser:"info",api:"warning",general:"default"}[a]||"default"}async function h(){try{const a=await m.getList();a.success&&(_.value=a.data||[])}catch(a){console.error("加载 Skills 失败",a)}}async function F(){if(f.value.trim()){k.value=!0;try{const a=await m.install(f.value.trim());a.success?(r.success(a.message||"安装成功"),b.value=!1,f.value="",h()):r.error(a.message||"安装失败")}catch(a){r.error("安装失败: "+a.message)}k.value=!1}}async function G(a,e){q.warning({title:"确认卸载",content:`确定要卸载 Skill "${e}" 吗？`,positiveText:"卸载",negativeText:"取消",onPositiveClick:async()=>{try{const t=await m.uninstall(a);t.success?(r.success(t.message),h()):r.error(t.message)}catch{r.error("卸载失败")}}})}async function H(a,e){try{await m.toggle(a,e)}catch{r.error("操作失败"),h()}}async function K(a){try{const e=await m.getDetail(a);e.success&&(x.value=e.data,z.value=!0)}catch{r.error("获取详情失败")}}async function D(){if(w.value.trim()){C.value=!0;try{const a=await m.search(w.value.trim());a.success?S.value=a.items||[]:r.warning(a.message||"搜索失败")}catch{r.error("搜索失败")}C.value=!1}}return Q(()=>{h()}),(a,e)=>(c(),u("div",null,[s("div",X,[e[8]||(e[8]=R('<div class="flex items-center gap-3"><div class="w-10 h-10 rounded-xl bg-gradient-to-br from-violet-500 to-purple-600 flex items-center justify-center shadow-lg"><i class="fas fa-puzzle-piece text-white text-lg"></i></div><div><h2 class="text-xl font-bold text-slate-800">Skills 管理</h2><p class="text-xs text-slate-400">管理已安装的 AI 测试技能</p></div></div>',1)),l(o(p),{type:"primary",onClick:e[0]||(e[0]=t=>b.value=!0)},{icon:n(()=>[...e[6]||(e[6]=[s("i",{class:"fas fa-plus"},null,-1)])]),default:n(()=>[e[7]||(e[7]=v(" 安装 Skill ",-1))]),_:1})]),s("div",Y,[(c(),u(N,null,j(A,t=>l(o(T),{key:t.value,type:y.value===t.value?"primary":"default",bordered:y.value!==t.value,round:"",class:"cursor-pointer",onClick:g=>y.value=t.value},{default:n(()=>[v(i(t.label),1)]),_:2},1032,["type","bordered","onClick"])),64))]),U.value.length>0?(c(),u("div",Z,[(c(!0),u(N,null,j(U.value,t=>(c(),u("div",{key:t.id,class:"bg-white rounded-2xl border border-slate-100 shadow-sm hover:shadow-md transition-all p-5 flex flex-col"},[s("div",ee,[s("div",{class:I(["w-10 h-10 rounded-xl flex items-center justify-center text-lg",$(t.category).bg])},[s("i",{class:I([$(t.category).icon,"text-white"])},null,2)],2),l(o(W),{value:t.is_active,"onUpdate:value":[g=>t.is_active=g,g=>H(t.id,g===1)],"checked-value":1,"unchecked-value":0,size:"small"},null,8,["value","onUpdate:value"])]),s("h3",te,i(t.name),1),s("p",se,i(t.slug||t.source),1),s("p",ae,i(t.description||"暂无描述"),1),s("div",le,[s("div",ne,[l(o(T),{size:"tiny",round:"",bordered:!1,type:E(t.category)},{default:n(()=>[v(i(t.category||"general"),1)]),_:2},1032,["type"]),s("span",oe,i(t.author),1)]),s("div",ie,[l(o(p),{size:"tiny",quaternary:"",onClick:g=>K(t.id)},{icon:n(()=>[...e[9]||(e[9]=[s("i",{class:"fas fa-eye text-xs"},null,-1)])]),_:1},8,["onClick"]),l(o(p),{size:"tiny",quaternary:"",type:"error",onClick:g=>G(t.id,t.name)},{icon:n(()=>[...e[10]||(e[10]=[s("i",{class:"fas fa-trash text-xs"},null,-1)])]),_:1},8,["onClick"])])])]))),128))])):(c(),u("div",re,[...e[11]||(e[11]=[s("i",{class:"fas fa-puzzle-piece text-4xl mb-4 text-slate-300"},null,-1),s("p",{class:"text-lg"},"暂无已安装的 Skills",-1),s("p",{class:"text-sm mt-1"},'点击右上角"安装 Skill"开始',-1)])])),l(o(V),{show:b.value,"onUpdate:show":e[4]||(e[4]=t=>b.value=t),preset:"card",title:"安装 Skill",style:{width:"560px"}},{action:n(()=>[s("div",xe,[l(o(p),{onClick:e[3]||(e[3]=t=>b.value=!1)},{default:n(()=>[...e[16]||(e[16]=[v("取消",-1)])]),_:1}),l(o(p),{type:"primary",loading:k.value,disabled:!f.value.trim(),onClick:F},{default:n(()=>[...e[17]||(e[17]=[v(" 安装 ",-1)])]),_:1},8,["loading","disabled"])])]),default:n(()=>[s("div",ue,[l(o(B),{value:f.value,"onUpdate:value":e[1]||(e[1]=t=>f.value=t),placeholder:"输入 GitHub 仓库标识，如 anthropics/webapp-testing"},{prefix:n(()=>[...e[12]||(e[12]=[s("i",{class:"fab fa-github text-slate-400 mr-1"},null,-1)])]),_:1},8,["value"]),e[15]||(e[15]=s("div",{class:"text-xs text-slate-400"}," 从 GitHub 下载 Skill 的 Markdown 文件。格式: owner/repo ",-1)),s("div",de,[s("div",ce,[l(o(B),{value:w.value,"onUpdate:value":e[2]||(e[2]=t=>w.value=t),placeholder:"搜索 Skills...",size:"small",onKeydown:O(D,["enter"])},null,8,["value"]),l(o(p),{size:"small",onClick:D,loading:C.value},{default:n(()=>[...e[13]||(e[13]=[v("搜索",-1)])]),_:1},8,["loading"])]),S.value.length>0?(c(),u("div",ve,[(c(!0),u(N,null,j(S.value,t=>(c(),u("div",{key:t.slug,class:"flex items-center justify-between p-2 bg-slate-50 rounded-lg hover:bg-emerald-50 transition-colors"},[s("div",fe,[s("div",ge,i(t.name),1),s("div",pe,i(t.slug)+" · ⭐ "+i(t.stars),1)]),l(o(p),{size:"tiny",type:"primary",ghost:"",onClick:g=>f.value=t.slug},{default:n(()=>[...e[14]||(e[14]=[v("选择",-1)])]),_:1},8,["onClick"])]))),128))])):M("",!0)])])]),_:1},8,["show"]),l(o(V),{show:z.value,"onUpdate:show":e[5]||(e[5]=t=>z.value=t),preset:"card",title:"Skill 详情",style:{width:"640px"}},{default:n(()=>[x.value?(c(),u("div",me,[s("div",ye,[s("h3",be,i(x.value.name),1),l(o(T),{size:"small",round:""},{default:n(()=>[v(i(x.value.category),1)]),_:1})]),s("p",we,i(x.value.description),1),s("div",he,[s("pre",_e,i(x.value.content),1)])])):M("",!0)]),_:1},8,["show"])]))}};export{ze as default};
